{
  "models": {
    "orchestration": "auto"
  },
  "orchestration": {
    "budget": {
      "seconds": 120,
      "tokens": 100000
    }
  },
  "instructions": {
    "orchestration": "You are a performance benchmarking analyst helping users understand test results, compare configurations, and identify regressions or improvements.\n\nTool Selection:\n- Use 'query_benchmark_data' for questions about test results, metrics, comparisons, filtering by template/load_mode/table_type, and listing tests.\n- Use 'statistical_analysis' when comparing two tests to determine if differences are statistically significant.\n- Use 'cost_calculator' for cost analysis, credit consumption, and cost-efficiency comparisons.\n\nGuidelines:\n- Always check statistical significance when comparing tests using statistical_analysis.\n- For cost questions, calculate cost per query and queries per credit.\n- When presenting comparisons, include both raw values and percentage differences.\n- Flag any caveats about comparison confidence (e.g., different warehouse sizes, different load modes).",
    "response": "Be concise and data-driven. Lead with the key finding, then provide supporting evidence. Use tables for multi-row comparisons. When comparing tests, always mention whether the difference is statistically significant."
  },
  "tools": [
    {
      "tool_spec": {
        "type": "cortex_analyst_text_to_sql",
        "name": "query_benchmark_data",
        "description": "Query performance benchmark test results including QPS, latency metrics (P50, P95, P99), error rates, and FIND_MAX capacity metrics. Use for questions about test performance, comparisons between tests, filtering by template/load_mode/table_type, listing recent tests, and trend analysis. Supports table_type values: POSTGRES, HYBRID, STANDARD, ICEBERG, INTERACTIVE."
      }
    },
    {
      "tool_spec": {
        "type": "generic",
        "name": "statistical_analysis",
        "description": "Comprehensive statistical analysis combining rolling baseline statistics, trend analysis, and comparison verdicts. Use when comparing tests to determine if performance differences are significant. Returns confidence bands, coefficient of variation, and improvement/regression verdicts.",
        "input_schema": {
          "type": "object",
          "properties": {
            "P_TEST_ID": {
              "type": "string",
              "description": "The test ID to analyze"
            },
            "P_COMPARE_TO_TEST_ID": {
              "type": "string",
              "description": "Optional test ID to compare against. If not provided, compares against rolling baseline."
            },
            "P_INCLUDE_MANN_WHITNEY": {
              "type": "boolean",
              "description": "Set to true to include Mann-Whitney U test for query-level significance testing (requires both test IDs)"
            }
          },
          "required": ["P_TEST_ID"]
        }
      }
    },
    {
      "tool_spec": {
        "type": "generic",
        "name": "cost_calculator",
        "description": "Calculate cost metrics for tests including credit consumption, cost per query, cost per 1000 queries, and queries per credit. Use for cost-benefit analysis and comparing cost efficiency between different warehouse configurations.",
        "input_schema": {
          "type": "object",
          "properties": {
            "P_TEST_IDS": {
              "type": "array",
              "items": {"type": "string"},
              "description": "Array of test IDs to calculate costs for"
            },
            "P_COMPARISON_TYPE": {
              "type": "string",
              "enum": ["absolute", "per_query", "per_qps"],
              "description": "Type of cost comparison: 'absolute' for total costs, 'per_query' for cost efficiency"
            }
          },
          "required": ["P_TEST_IDS"]
        }
      }
    }
  ],
  "tool_resources": {
    "query_benchmark_data": {
      "semantic_view": "UNISTORE_BENCHMARK.TEST_RESULTS.BENCHMARK_ANALYTICS",
      "execution_environment": {
        "type": "warehouse",
        "warehouse": "COMPUTE_WH",
        "query_timeout": 300
      }
    },
    "statistical_analysis": {
      "type": "procedure",
      "identifier": "UNISTORE_BENCHMARK.TEST_RESULTS.STATISTICAL_ANALYSIS",
      "execution_environment": {
        "type": "warehouse",
        "warehouse": "COMPUTE_WH",
        "query_timeout": 300
      }
    },
    "cost_calculator": {
      "type": "procedure",
      "identifier": "UNISTORE_BENCHMARK.TEST_RESULTS.COST_CALCULATOR",
      "execution_environment": {
        "type": "warehouse",
        "warehouse": "COMPUTE_WH",
        "query_timeout": 300
      }
    }
  }
}
